(window.webpackJsonp=window.webpackJsonp||[]).push([[12],{204:function(s,n,a){"use strict";a.r(n);var e=a(0),t=Object(e.a)({},function(){var s=this,n=s.$createElement,a=s._self._c||n;return a("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[a("h1",{attrs:{id:"redis"}},[s._v("Redis")]),s._v(" "),a("p"),a("div",{staticClass:"table-of-contents"},[a("ul",[a("li",[a("a",{attrs:{href:"#redis是什么"}},[s._v("Redis是什么")])]),a("li",[a("a",{attrs:{href:"#redis使用场景"}},[s._v("Redis使用场景")])]),a("li",[a("a",{attrs:{href:"#redis支持哪些数据结构"}},[s._v("Redis支持哪些数据结构")])]),a("li",[a("a",{attrs:{href:"#redis分布式锁"}},[s._v("Redis分布式锁")])]),a("li",[a("a",{attrs:{href:"#实现异步队列"}},[s._v("实现异步队列")])]),a("li",[a("a",{attrs:{href:"#同步机制-主从复制"}},[s._v("同步机制 (主从复制)")])]),a("li",[a("a",{attrs:{href:"#哨兵机制-hearts"}},[s._v("哨兵机制(♥️)")])]),a("li",[a("a",{attrs:{href:"#持久化"}},[s._v("持久化")])]),a("li",[a("a",{attrs:{href:"#常见问题"}},[s._v("常见问题")])]),a("li",[a("a",{attrs:{href:"#淘汰策略"}},[s._v("淘汰策略")])])])]),a("p"),s._v(" "),a("h2",{attrs:{id:"redis是什么"}},[s._v("Redis是什么")]),s._v(" "),a("p",[s._v("开源的，内存中的数据结构存储系统。")]),s._v(" "),a("p",[s._v("基于内存又可持久化、key-value数据库。")]),s._v(" "),a("p",[s._v("可以用作数据库、缓存和消息中间件。")]),s._v(" "),a("h2",{attrs:{id:"redis使用场景"}},[s._v("Redis使用场景")]),s._v(" "),a("ul",[a("li",[s._v("缓存，session缓存")]),s._v(" "),a("li",[s._v("消息队列")]),s._v(" "),a("li",[s._v("分布式锁")])]),s._v(" "),a("h2",{attrs:{id:"redis支持哪些数据结构"}},[s._v("Redis支持哪些数据结构")]),s._v(" "),a("ul",[a("li",[s._v("String")]),s._v(" "),a("li",[s._v("list")]),s._v(" "),a("li",[s._v("hash")]),s._v(" "),a("li",[s._v("set")]),s._v(" "),a("li",[s._v("sortedset")])]),s._v(" "),a("h2",{attrs:{id:"redis分布式锁"}},[s._v("Redis分布式锁")]),s._v(" "),a("ul",[a("li",[a("p",[s._v("setnx  expire")]),s._v(" "),a("p",[s._v("setnx争抢锁，抢到之后用expire给锁加一个过期时间，防止锁忘记释放")]),s._v(" "),a("p",[s._v("在释放锁之前，当前进程crash或重启，会怎样？把setnx和expire合成一条指令来使用")])])]),s._v(" "),a("h2",{attrs:{id:"实现异步队列"}},[s._v("实现异步队列")]),s._v(" "),a("p",[s._v("用List结构作为队列，rpush生产消息，当lpop没有消息时，sleep一会再重试")]),s._v(" "),a("h2",{attrs:{id:"同步机制-主从复制"}},[s._v("同步机制 (主从复制)")]),s._v(" "),a("p",[s._v("配置：")]),s._v(" "),a("p",[a("code",[s._v("slaveof <masterip> <masterport>")])]),s._v(" "),a("h2",{attrs:{id:"哨兵机制"}},[s._v("哨兵机制(♥️)")]),s._v(" "),a("ul",[a("li",[s._v("解决主从复制的缺点")]),s._v(" "),a("li",[s._v("当主节点出现故障，由Redis sentinel自动完成故障发现和转移，实现高可用")])]),s._v(" "),a("h2",{attrs:{id:"持久化"}},[s._v("持久化")]),s._v(" "),a("ul",[a("li",[a("p",[s._v("RDB   快照")]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("##rdb配置相关\n\n#时间策略\nsave 900 1\nsave 300 10\nsave 60 10000\n\n#文件名称\ndbfilename dump.rdb\n\n#文件保存路径\ndir ./\n\n#如果持久化出错，主进程停止写入\nstop-writes-on-bgsave-error yes\n\n# 是否对RDB文件进行压缩，默认是yes\nrdbcompression yes\n\n#是否对rdb文件进行校验，默认是yes\nrdbchecksum yes\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br")])])]),s._v(" "),a("li",[a("p",[s._v("AOF   保存命令重新执行：包括命令的实时写入，AOF文件的重写")]),s._v(" "),a("p",[s._v("命令写入--》追加到aof_buf--》同步到磁盘AOF文件。")]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v('##aof配置相关\n\n#是否开启AOF\nappendonly no\n\n# The name of the append only file (default: "appendonly.aof")\nappendfilename "appendonly.aof"\n\n#三种同步策略\n#每次接受到写命令，强制写入磁盘\n# appendfsync always\n\n#每秒写入一次\nappendfsync everysec\n#完全依赖操作系统写入\n# appendfsync no\n\n#在日志重写时，不进行命令追加操作，而是将其放到缓冲区里，避免与命令的追加造成DISK IO的冲突\nno-appendfsync-on-rewrite no\n#当前AOF文件是上次日志重写得到AOF文件大小的两倍时，自动启动新的日志重写过程\nauto-aof-rewrite-percentage 100\n#当前AOF文件启动新的日志重写过程的最小值，避免频繁重写\nauto-aof-rewrite-min-size 64mb\n\n#加载aof时如果有错如何处理\naof-load-truncated yes\n\n# 文件重写策略\naof-rewrite-incremental-fsync yes\n\n')])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br"),a("span",{staticClass:"line-number"},[s._v("22")]),a("br"),a("span",{staticClass:"line-number"},[s._v("23")]),a("br"),a("span",{staticClass:"line-number"},[s._v("24")]),a("br"),a("span",{staticClass:"line-number"},[s._v("25")]),a("br"),a("span",{staticClass:"line-number"},[s._v("26")]),a("br"),a("span",{staticClass:"line-number"},[s._v("27")]),a("br"),a("span",{staticClass:"line-number"},[s._v("28")]),a("br"),a("span",{staticClass:"line-number"},[s._v("29")]),a("br"),a("span",{staticClass:"line-number"},[s._v("30")]),a("br")])])])]),s._v(" "),a("h2",{attrs:{id:"常见问题"}},[s._v("常见问题")]),s._v(" "),a("ul",[a("li",[s._v("缓存雪崩  大量缓存失效，请求转到数据库，造成数据库的压力；设置失效时间点均匀分布，避免雪崩；在时间上加一个随机值，使得过期时间分散；")]),s._v(" "),a("li",[s._v("缓存穿透   命中率； 缓存未命中，查询数据库空；设置默认值放到缓存里，这样就不会继续访问数据库")]),s._v(" "),a("li",[s._v("实现消息队列，队列满了怎么办，消费不完怎么办？")])]),s._v(" "),a("h2",{attrs:{id:"淘汰策略"}},[s._v("淘汰策略")]),s._v(" "),a("ol",[a("li",[s._v("设置过期中最近最少使用")]),s._v(" "),a("li",[s._v("设置过期中将要过期的")]),s._v(" "),a("li",[s._v("设置过期中任意数")]),s._v(" "),a("li",[s._v("最近最少使用")]),s._v(" "),a("li",[s._v("任意")])])])},[],!1,null,null,null);n.default=t.exports}}]);